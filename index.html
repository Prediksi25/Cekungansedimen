<!DOCTYPE html><html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HCPrediksi ‚Äì Perkiraan Titik Sumur</title><link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/html2canvas@1.4.1/dist/html2canvas.min.js"></script><style>
html,body{margin:0;height:100%;font-family:Arial,sans-serif;background:#000}
#map{width:100%;height:100%}
#header{
  position:absolute;top:10px;left:50%;transform:translateX(-50%);
  z-index:999;background:rgba(0,0,0,.6);padding:6px 14px;
  border-radius:14px;text-align:center
}
#header h1{margin:0;font-size:16px;color:#4de3ff}
#header p{margin:0;font-size:10px;color:#ccc}

#panel{
  position:absolute;top:70px;left:10px;z-index:999;
  background:rgba(0,0,0,.65);padding:10px;border-radius:12px;
  font-size:11px;color:#fff
}

#panel b{color:#4de3ff}

#depthPanel{
  position:absolute;bottom:90px;right:10px;z-index:999;
  background:rgba(0,0,0,.7);padding:10px;border-radius:12px;
  width:170px;display:none
}

#depthChart{width:150px;height:90px;background:#000;border-radius:6px}

#pressure{margin-top:6px;height:8px;background:rgba(255,255,255,.15);border-radius:6px;overflow:hidden}
#pressureBar{height:100%;width:0%;background:linear-gradient(90deg,#3b82f6,#ffd500,#ff3b3b)}

button{
  width:100%;margin-top:6px;padding:6px;font-size:11px;
  border-radius:8px;border:1px solid rgba(255,255,255,.25);
  background:#111;color:#fff
}

#note{
  position:absolute;bottom:20px;left:50%;transform:translateX(-50%);
  background:rgba(0,0,0,.65);color:#ddd;font-size:9px;
  padding:6px 10px;border-radius:10px;text-align:center;z-index:999
}
</style></head>
<body><div id="header">
  <h1>HCPrediksi</h1>
  <p>Perkiraan Titik Sumur yang Mengandung Minyak</p>
</div><div id="panel">
  üì° <b>GPS Aktif</b><br>
  üìç Area Analisis: 2 km<br>
  üîé Mode: Prediksi Visual
</div><div id="depthPanel">
  <canvas id="depthChart" width="150" height="90"></canvas>
  <div id="pressure"><div id="pressureBar"></div></div>
  <button id="exportAll">Export Peta + Grafik</button>
</div><div id="note">
‚ö†Ô∏è Aplikasi ini perkiraan visual berbasis GPS.<br>
Tidak mewakili data geologi/geofisika resmi.
</div><div id="map"></div><script>
const map = L.map('map');
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19}).addTo(map);

const chart = document.getElementById('depthChart');
const ctx = chart.getContext('2d');

function drawGraph(depth,color){
  ctx.clearRect(0,0,150,90);
  const h = Math.min(80, depth/10);
  const y = 85 - h;
  ctx.fillStyle=color;
  ctx.fillRect(60,y,30,h);
  ctx.strokeStyle='rgba(255,255,255,.4)';
  for(let i=0;i<5;i++){
    ctx.beginPath();
    ctx.moveTo(60+Math.random()*30,y+Math.random()*h);
    ctx.lineTo(50+Math.random()*50,y+Math.random()*h);
    ctx.stroke();
  }
  ctx.fillStyle='#fff';
  ctx.font='10px Arial';
  ctx.fillText(depth+' m',52,y-4);
}

function setPressure(depth){
  const p = Math.min(100,Math.max(20,Math.round(depth/15)));
  document.getElementById('pressureBar').style.width=p+'%';
}

let centerLat, centerLon;

navigator.geolocation.getCurrentPosition(pos=>{
  centerLat = pos.coords.latitude;
  centerLon = pos.coords.longitude;

  map.setView([centerLat,centerLon],14);

  const layers = [
    {r:800,color:'#ff3b3b',op:0.12,label:'MINYAK'},
    {r:1400,color:'#ffd500',op:0.10,label:'SEDANG'},
    {r:2000,color:'#3b82f6',op:0.08,label:'KOSONG'}
  ];

  layers.forEach(l=>{
    L.circle([centerLat,centerLon],{
      radius:l.r,color:l.color,fillColor:l.color,
      fillOpacity:l.op,weight:2
    }).addTo(map);
  });

  const marker = L.circleMarker([centerLat,centerLon],{
    radius:6,color:'#fff',fillColor:'#4de3ff',fillOpacity:1
  }).addTo(map);

  map.on('click',()=>{
    const depth = Math.floor(400+Math.random()*600);
    document.getElementById('depthPanel').style.display='block';
    drawGraph(depth,'#ff3b3b');
    setPressure(depth);
  });
});

// Export map + graph

document.getElementById('exportAll').onclick=async()=>{
  const mapCanvas = await html2canvas(document.getElementById('map'));
  const final = document.createElement('canvas');
  final.width = mapCanvas.width;
  final.height = mapCanvas.height;
  const fctx = final.getContext('2d');
  fctx.drawImage(mapCanvas,0,0);
  fctx.drawImage(chart,final.width-180,final.height-120);
  fctx.fillStyle='rgba(0,0,0,.6)';
  fctx.fillRect(0,0,final.width,36);
  fctx.fillStyle='#fff';
  fctx.font='14px Arial';
  fctx.fillText('HCPrediksi ‚Äì Perkiraan Titik Sumur',12,24);

  const a=document.createElement('a');
  a.download='HCPrediksi_Peta_Grafik.png';
  a.href=final.toDataURL('image/png');
  a.click();
};
</script></body>
</html>
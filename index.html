<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>HCPrediksi</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:radial-gradient(circle at top,#001f3f,#000);
  color:#fff;
}
#title{
  position:absolute;
  top:10px;
  width:100%;
  text-align:center;
  z-index:1000;
}
#logo{
  font-size:22px;
  font-weight:bold;
  letter-spacing:1px;
  color:#00ffff;
  text-shadow:0 0 10px rgba(0,255,255,.6);
}
#title small{font-size:12px;opacity:.8}
#map{width:100vw;height:100vh}
#info{
  position:absolute;
  bottom:15px;left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,.7);
  padding:10px 14px;border-radius:12px;
  font-size:12px;text-align:center;z-index:1000;
}
#panel{
  position:fixed;top:50px;left:10px;
  background:rgba(0,0,0,.7);
  padding:10px;border-radius:12px;
  font-size:12px;z-index:1000;
}
#disclaimer{
  position:fixed;bottom:90px;left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,.6);
  padding:8px 12px;border-radius:10px;
  font-size:11px;text-align:center;z-index:1000;max-width:90%;
}
#watermark{
  position:fixed;bottom:5px;right:10px;
  font-size:10px;opacity:.4;z-index:1000;
}
</style>
</head>

<body>

<div id="title">
  <span id="logo">HCPrediksi</span><br>
  <small>Perkiraan Titik Sumur yang Mengandung Minyak</small>
</div>

<div id="map"></div>

<div id="panel">
  üì° GPS Aktif<br>
  üß≠ Area Analisis: 2 km<br>
  üåã Mode: Prediksi Visual
</div>

<div id="disclaimer">
‚ö†Ô∏è Aplikasi ini merupakan simulasi visual berbasis GPS.<br>
Tidak mewakili data geologi/geofisika resmi dan tidak untuk keputusan pengeboran.
</div>

<div id="info">
Klik area <b>dalam radius GPS</b> untuk melihat prediksi.
</div>

<div id="watermark">HCPrediksi ¬© Simulation</div>

<audio id="alertSound">
  <source src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg">
</audio>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
let userLat=null,userLon=null,userArea=null;
let scanCircle=null,scanAngle=0;

/* MAP & LAYERS */
const map=L.map('map').setView([-2.5,118],5);

const normalMap=L.tileLayer(
  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:18}
);
const satelitMap=L.tileLayer(
  'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
  {maxZoom:18}
);
normalMap.addTo(map);
L.control.layers({"Peta Normal":normalMap,"Satelit":satelitMap}).addTo(map);

/* GPS AUTO */
navigator.geolocation.getCurrentPosition(pos=>{
  userLat=pos.coords.latitude;
  userLon=pos.coords.longitude;
  map.setView([userLat,userLon],14);

  L.circleMarker([userLat,userLon],{
    radius:8,color:"#fff",fillColor:"#fff",fillOpacity:1
  }).addTo(map).bindPopup("Lokasi GPS Anda");

  userArea=L.circle([userLat,userLon],{
    radius:2000,color:"#00ffff",fillColor:"#00ffff",fillOpacity:.06
  }).addTo(map);

  drawBasins();
  startScanRing();
  startSweepLine();

},()=>alert("GPS tidak aktif"),{enableHighAccuracy:true});

/* CEKUNGAN TRANSPARAN */
function drawBasins(){
  for(let i=0;i<5;i++){
    const latO=(Math.random()-.5)*.02;
    const lonO=(Math.random()-.5)*.02;
    L.circle([userLat+latO,userLon+lonO],{
      radius:600+Math.random()*800,
      color:"orange",fillColor:"orange",fillOpacity:.15
    }).addTo(map);
  }
}

/* SCAN RING */
function startScanRing(){
  let r=300;
  scanCircle=L.circle([userLat,userLon],{
    radius:r,color:"#00ffff",fillColor:"#00ffff",
    fillOpacity:.05,weight:2
  }).addTo(map);
  setInterval(()=>{
    r+=80; if(r>2000) r=300;
    scanCircle.setRadius(r);
  },120);
}

/* SWEEP RADAR */
function startSweepLine(){
  const sweep=L.polyline([],{
    color:"#00ffff",weight:2,opacity:.7
  }).addTo(map);
  setInterval(()=>{
    scanAngle+=5; if(scanAngle>=360) scanAngle=0;
    const rad=scanAngle*Math.PI/180;
    const d=2000/111000;
    const lat2=userLat+Math.cos(rad)*d;
    const lon2=userLon+Math.sin(rad)*d;
    sweep.setLatLngs([[userLat,userLon],[lat2,lon2]]);
  },80);
}

/* DETEKSI */
map.on('click',e=>{
  if(!userArea||!userArea.getBounds().contains(e.latlng)){
    alert("Deteksi hanya di area GPS Anda"); return;
  }
  const r=Math.random();
  let status,color,score,sound=false;

  if(r>.66){status="ADA MINYAK";color="red";score=70+Math.floor(Math.random()*30);sound=true;}
  else if(r>.33){status="SEDANG";color="yellow";score=40+Math.floor(Math.random()*30);sound=true;}
  else{status="KOSONG";color="blue";score=Math.floor(Math.random()*40);}

  if(sound) document.getElementById("alertSound").play();

  L.circle(e.latlng,{radius:1000,color,fillColor:color,fillOpacity:.15}).addTo(map);
  L.circleMarker(e.latlng,{radius:10,color,fillColor:color,fillOpacity:.9})
   .addTo(map)
   .bindPopup(`
     <b>Status:</b> ${status}<br>
     <b>Skor Potensi:</b> ${score}%<br>
     <b>Latitude:</b> ${e.latlng.lat.toFixed(6)}<br>
     <b>Longitude:</b> ${e.latlng.lng.toFixed(6)}
   `).openPopup();
});
</script>

</body>
</html>